<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Empirical comparison of traditional and Bayesian approaches to estimate survival, recruitment and trend • bbousuite</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical comparison of traditional and Bayesian approaches to estimate survival, recruitment and trend">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bbousuite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/empirical-comparisons.html">Empirical comparison of traditional and Bayesian approaches to estimate survival, recruitment and trend</a></li>
    <li><a class="dropdown-item" href="../articles/simulations.html">Boreal Caribou Simulations Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/poissonconsulting/bbousuite/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Empirical comparison of traditional and Bayesian approaches to estimate survival, recruitment and trend</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/poissonconsulting/bbousuite/blob/main/vignettes/articles/empirical-comparisons.Rmd" class="external-link"><code>vignettes/articles/empirical-comparisons.Rmd</code></a></small>
      <div class="d-none name"><code>empirical-comparisons.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The overall objective of empirical comparisons is to explore the
working characteristics of the Bayesian Hatter-Bergerud method for
estimation of trend. This methodology is an evolution of the traditional
simulation-based approach and therefore practitioners will be interested
in how the Bayesian methods perform relative to the traditional methods.
A key objective is understanding how Bayesian approaches may offset low
sample sizes of observations (collared caribou or groups observed during
composition surveys) which is typical of caribou data sets.</p>
<p>We note that empirical comparisons are limited in that true parameter
values are not known. Therefore, we can only conclude whether estimates
are similar or different between approaches rather than infer bias. To
fully explore estimators we also present <a href="https://poissonconsulting.github.io/bbousuite/articles/simulations.html">simulations</a>
which allow assessment of bias and working characteristics across a full
range of scenarios.</p>
</div>
<div class="section level2">
<h2 id="methods-and-results">Methods and results<a class="anchor" aria-label="anchor" href="#methods-and-results"></a>
</h2>
<p>We first detail the methods that are used to estimate survival,
recruitment and λ. We then compare field-based estimates from Bayesian
and traditional approaches. Finally, we use simulations to further
explore performance of each approach.</p>
<div class="section level3">
<h3 id="differences-and-similarities-in-traditional-and-bayesian-approaches">Differences and similarities in traditional and Bayesian
approaches<a class="anchor" aria-label="anchor" href="#differences-and-similarities-in-traditional-and-bayesian-approaches"></a>
</h3>
<p>A key difference in traditional, fixed effect, and random effects
methods is how yearly and monthly estimates are treated. When a
categorical variable, such as year or month is treated as a
<em>fixed</em> effect each parameter value is estimated in isolation.
Traditional methods treat variables as fixed effects. In contrast, when
variables are treated as a <em>random</em> effect the parameter values
are assumed to be drawn from a common underlying distribution which
allows the typical values to be estimated and each parameter estimate to
be influenced by the other ones.</p>
<p>The other difference in traditional and Bayesian approaches is
whether the data is assumed to come from a pre-defined statistical
distribution. Traditional approaches are <em>non-parametric</em> meaning
they do not assume the data comes from any statistical distribution with
estimates based on simple ratios. Variances are then estimated using
approximation formulas (survival) or bootstrap resampling methods.
Bayesian fixed and random effects model survival and recruitment use a
<em>parametric</em> approach with survival and recruitment modeled using
a binomial distribution. The main advantage of the Bayesian fixed and
random effects models is that inference is based on an underlying
statistical model allowing inference on statistical significance of
model parameters. For example, models that assume an underlying trend in
demographic parameters can be applied using the parametric approach. In
addition, estimates of standard error can be derived for years with 0
mortalities using fixed effects models in comparison with traditional
approaches where a confidence interval is not possible.</p>
</div>
<div class="section level3">
<h3 id="review-of-formulas-used-to-estimate-survival-recruitment-and-trend-">Review of formulas used to estimate survival, recruitment, and
trend.<a class="anchor" aria-label="anchor" href="#review-of-formulas-used-to-estimate-survival-recruitment-and-trend-"></a>
</h3>
<div class="section level4">
<h4 id="survival-s">Survival,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#survival-s"></a>
</h4>
<p>Traditional and Bayesian methods use the staggered entry Kaplan-Meier
method, which is defined algebraically below <span class="citation">(Pollock et al. 1989)</span>. The probability of
surviving in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
time step (usually month) is given by the equation below</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>S</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>d</mi><mi>i</mi></msub><msub><mi>r</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex"> \hat{S}_{i} = 1 - \frac{d_{i}}{r_{i}} </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_{i}</annotation></semantics></math>
is the number of mortalities during the period and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>i</mi></msub><annotation encoding="application/x-tex">r_{i}</annotation></semantics></math>
is the number of collared individuals at the start of period. The
estimated survival for any arbitrary time period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
(usually year) is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>S</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>S</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \hat{S}(t) = \prod_{i=1}(\hat{S}_{i,t}) </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is the survival during the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
time step of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>th
period. Traditional approaches use the simple product of monthly
survival estimates to obtain yearly survival estimates. Bayesian
approaches model survival based on binomial distribution. Fixed effects
Bayesian models treat monthly survival as a random effect with yearly
survival as a fixed effect meaning that a parameter is estimated for
every year. Further details on the Kaplan-Meier approach as applied in
boreal caribou studies are given in
<code>vignette("previous-methods")</code>.</p>
</div>
<div class="section level4">
<h4 id="recruitment-r">Recruitment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#recruitment-r"></a>
</h4>
<p>Both traditional and Bayesian approaches estimate recruitment
following the methods of DeCesare et al. <span class="citation">(2012)</span>. The age ratio,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>,
is commonly estimated as the number of calves,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><msub><mi></mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">n{_j}</annotation></semantics></math>,
per adult female,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>a</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">n_{af}</annotation></semantics></math>,
observed at the end of a measured year, such that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mfrac><msub><mi>n</mi><mi>j</mi></msub><msub><mi>n</mi><mrow><mi>a</mi><mi>f</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">X = \frac{n_j}{n_{af}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>⋅</mo><mi>s</mi><mi>e</mi><mi>x</mi><mi>_</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">X \cdot sex\_ratio</annotation></semantics></math>
estimates the number of female calves
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mrow><mi>j</mi><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n_{jf})</annotation></semantics></math>
per adult female.</p>
<p>Recruitment is estimated using the equation below which accounts for
recruitment of calves into the yearling/adult age class at the end of
the caribou year.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>R</mi><mi>M</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>X</mi><mo>⋅</mo><mi>s</mi><mi>e</mi><mi>x</mi><mi>_</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi></mrow><mrow><mn>1</mn><mo>+</mo><mi>X</mi><mo>⋅</mo><mi>s</mi><mi>e</mi><mi>x</mi><mi>_</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">R_{RM} = \frac{X \cdot sex\_ratio}{1 + X \cdot sex\_ratio}</annotation></semantics></math></p>
<p>For traditional methods, estimates are based upon the raw ratios from
field data whereas recruitment is modelled based on a binomial
distribution for Bayesian methods.</p>
</div>
<div class="section level4">
<h4 id="population-growth-lambda">Population Growth,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#population-growth-lambda"></a>
</h4>
<p>Both traditional and Bayesian approaches use the basic
Hatter-Bergerud method <span class="citation">(Hatter and Bergerud
1991)</span>.</p>
<p>The basic Hatter-Bergerud equation used to estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is given below.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\lambda = \frac{(S)}{(1 - R)}</annotation></semantics></math>
Variance for lambda estimates is estimated using a simulation approach
for traditional approach whereas variances are estimates using Markov
Monte Carlo methods for Bayesian approaches. The resulting estimates and
variances are influenced by individual assumptions made in estimation of
survival and recruitment.</p>
</div>
</div>
<div class="section level3">
<h3 id="empirical-comparisons">Empirical comparisons<a class="anchor" aria-label="anchor" href="#empirical-comparisons"></a>
</h3>
<p>We use a 32 year field data set (data set “A” in <a href="https://poissonconsulting.github.io/bboudata/" class="external-link"><code>bboudata</code></a>)
to compare methodologies. For this data we use <a href="https://poissonconsulting.github.io/bbouretro/" class="external-link"><code>bbouretro</code></a>
to estimate traditional and <a href="https://poissonconsulting.github.io/bboutools/" class="external-link"><code>bboutools</code></a>
to estimate fixed and random effects survival, recruitment, and
trend.</p>
<p>A comparison of estimates reveals similarity between fixed effect and
traditional estimates (Figure 1). This result is intuitive given that
both approaches are treating years as independent data sets and given
that the underlying formulae from the 2 approaches are similar. The main
difference is between random effects and traditional/fixed effect
estimates. In this case it can be seen that the distribution of random
effect estimates is truncated with lower estimates from random effects
models being higher than traditional/random effects and vice versa for
higher estimates. This is due to “shrinkage” of estimates. Namely, the
sharing of information across years by random effects estimates causes
outlier estimates to be brought towards the mean random effect value.
This is particularly the case when the underlying data from estimates is
sparse. For example, the lowest estimate of survival (0.6) was based on
a mean sample size of 7.2 collars monitored per year.</p>
<p><img src="figures/Fig1.png" width="100%"><em><font size="-1">Fig.
1: Comparison of traditional and Bayesian estimates of survival,
recruitment and λ.</font></em></p>
<p>A yearly plot reveals similar trends with random effects estimates
showing the least variation compared to traditional and fixed effects
estimates (Figure 2). Most notable are difference in 1990 and 1991 where
collar sample sizes were lower (&lt;10 collars monitored per month)
creating estimates of survival at or near 1 for traditional and fixed
effects estimates. However, all methods follow the general temporal
trends in estimates.</p>
<p><img src="figures/Fig2.png" width="100%"><em><font size="-1">Fig.
2: Comparison of traditional and Bayesian estimates of survival,
recruitment and λ by year.</font></em></p>
<p>Of additional interest is the relative precision of estimates as
indicated by the width of the confidence interval divided by the
estimate. A comparison of traditional and Bayesian fixed and random
effects reveals higher estimated precision for random effect estimators
whereas estimated precision of fixed effect and traditional approaches
is relatively similar (Figure 3).</p>
<p><img src="figures/Fig3.png" width="100%"><em><font size="-1">Fig.
3: Relative estimated precision of traditional, random and fixed effects
methods. Precision is indexed by the width of the confidence limit
divided by the estimate.</font></em></p>
<p>One of the main factors influencing estimate precision is sample size
of the data set used to obtain estimates. The influence of sample size
was explored for survival rate estimates by plotting the mean number of
collars monitored in comparison to point estimates and relative
precision of estimates as indexed by confidence interval width divided
by the estimate. This comparison reveals how traditional and Bayesian
fixed effects are more influenced by sample size in terms of point
estimates (Figure 4) and estimated precision (Figure 5) compared to
random effects models. When sample sizes a larger range of survival
rates result including unrealistically low or high estimates with
traditional and fixed effects models.</p>
<p><img src="figures/Fig4.png" width="100%"><em><font size="-1">Fig.
4: Comparison of the effect of mean collars monitored on point estimates
of survival from traditional and Bayesian random and fixed effect
estimators.</font></em></p>
<p>Relative precision of estimates is also influenced by sample size of
collars with both traditional and fixed effects methods (Figure 5).
Differences in estimated precision for fixed effects and traditional
models are partially caused by fixed effects models estimating a
confidence limit when survival estimates are 1 (no deaths).</p>
<p><img src="figures/Fig5.png" width="100%"></p>
<p><em><font size="-1">Fig. 5: Comparison of the effect of mean collars
monitored on point estimates of survival from traditional and Bayesian
random and fixed effect estimators.</font></em></p>
<p>The main reason for differences in estimates is that traditional and
fixed effects approaches consider each yearly data set independently
whereas random effects models consider the entire multi-year data set
(as being drawn from a distribution of survival values). As a result,
estimates are more stable from random effects models.</p>
</div>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<p>Empirical comparisons illustrate the potential advantages of using
random effects methods to estimate survival, recruitment, and trend.
Namely, sharing of information across years with random effects models
potentially offsets issues with sparse data creating unrealistic
estimates with traditional and fixed effect approaches. The main
question is whether there are cases where random effects may create bias
by dismissing low or high parameter estimates when they are actually
occurring. To explore this question as well as overall performance of
estimators we use <a href="https://poissonconsulting.github.io/bbousuite/articles/simulations.html">simulations</a>.
Unlike empirical comparisons, simulations allow assessment of
performance with known true parameter values therefore allowing further
assessment of overall estimate performance.</p>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-decesare_estimating_2012" class="csl-entry">
DeCesare, Nicholas J., Mark Hebblewhite, Mark Bradley, Kirby G. Smith,
David Hervieux, and Lalenia Neufeld. 2012. <span>“Estimating Ungulate
Recruitment and Growth Rates Using Age Ratios.”</span> <em>The Journal
of Wildlife Management</em> 76 (1): 144–53. <a href="https://doi.org/10.1002/jwmg.244" class="external-link">https://doi.org/10.1002/jwmg.244</a>.
</div>
<div id="ref-hatter_moose_1991" class="csl-entry">
Hatter, Ian, and Wendy Bergerud. 1991. <span>“Moose
<span>Recuriment</span> <span>Adult</span> <span>Mortality</span> and
<span>Rate</span> of <span>Change</span>”</span> 27: 65–73.
</div>
<div id="ref-pollock_survival_1989" class="csl-entry">
Pollock, Kenneth H., Scott R. Winterstein, Christine M. Bunck, and Paul
D. Curtis. 1989. <span>“Survival <span>Analysis</span> in
<span>Telemetry</span> <span>Studies</span>: <span>The</span>
<span>Staggered</span> <span>Entry</span> <span>Design</span>.”</span>
<em>The Journal of Wildlife Management</em> 53 (1): 7. <a href="https://doi.org/10.2307/3801296" class="external-link">https://doi.org/10.2307/3801296</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Seb Dalgarno, John Boulanger, Ayla Pearson, Joe Thorley, Troy Hegel, Barry Nobert, Dave Hervieux.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
